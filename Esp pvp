--[[ 
    DEXTER BRM5 - PHI√äN B·∫¢N FIX HI·ªÇN TH·ªä
    - ƒê√£ th√™m n√∫t b·∫•m "D" ƒë·ªÉ m·ªü Menu tr√™n m·ªçi thi·∫øt b·ªã.
    - Gi·ªØ nguy√™n to√†n b·ªô t√≠nh nƒÉng Aim/Wall/No Recoil c·ªßa b·∫°n.
]]

local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- 1. X√ìA GUI C≈® N·∫æU C√ì
if PlayerGui:FindFirstChild("Dexter_Fixed_UI") then
    PlayerGui:FindFirstChild("Dexter_Fixed_UI"):Destroy()
end

-- 2. T·∫†O GUI M·ªöI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "Dexter_Fixed_UI"
ScreenGui.Parent = PlayerGui
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- 3. N√öT MINI DRAGGABLE (Ch·ªØ D)
local MiniButton = Instance.new("Frame")
local UICorner = Instance.new("UICorner")
local ButtonLabel = Instance.new("TextLabel")
local ClickBtn = Instance.new("TextButton")

MiniButton.Name = "MiniButton"
MiniButton.Parent = ScreenGui
MiniButton.BackgroundColor3 = Color3.fromRGB(0, 162, 255)
MiniButton.Position = UDim2.new(0, 20, 0, 150)
MiniButton.Size = UDim2.new(0, 50, 0, 50)
MiniButton.Active = true
MiniButton.Draggable = true -- H·ªó tr·ª£ k√©o th·∫£ c∆° b·∫£n

UICorner.CornerRadius = UDim.new(1, 0)
UICorner.Parent = MiniButton

ButtonLabel.Parent = MiniButton
ButtonLabel.BackgroundTransparency = 1
ButtonLabel.Size = UDim2.new(1, 0, 1, 0)
ButtonLabel.Font = Enum.Font.GothamBold
ButtonLabel.Text = "D"
ButtonLabel.TextColor3 = Color3.new(1, 1, 1)
ButtonLabel.TextSize = 25

ClickBtn.Parent = MiniButton
ClickBtn.BackgroundTransparency = 1
ClickBtn.Size = UDim2.new(1, 0, 1, 0)
ClickBtn.Text = ""

-- 4. KHUNG MENU CH√çNH (G·ªôp t·ª´ m√£ c·ªßa b·∫°n)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.Size = UDim2.new(0, 260, 0, 420)
MainFrame.Position = UDim2.new(0.5, -130, 0.5, -210)
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MainFrame.Visible = true -- Hi·ªán menu ngay khi ch·∫°y
MainFrame.Active = true
MainFrame.Draggable = true
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 8)

-- N√∫t b·∫•m Mini ƒë·ªÉ ·∫©n/hi·ªán
ClickBtn.MouseButton1Click:Connect(function()
    MainFrame.Visible = not MainFrame.Visible
end)

-- 5. CH√àN TO√ÄN B·ªò LOGIC C·ª¶A B·∫†N V√ÄO ƒê√ÇY
task.spawn(function()
    local RunService = game:GetService("RunService")
    local Workspace = game:GetService("Workspace")
    
    -- C√°c bi·∫øn c·∫•u h√¨nh t·ª´ m√£ g·ªëc
    local wallEnabled = false
    local aimEnabled = false
    local fovEnabled = false
    local fovRadius = 100
    local smoothing = 95
    
    -- H√†m h·ªó tr·ª£ t·∫°o n√∫t trong Menu
    local function createMenuButton(text, yPos, color)
        local btn = Instance.new("TextButton", MainFrame)
        btn.Size = UDim2.new(0.9, 0, 0, 35)
        btn.Position = UDim2.new(0.05, 0, 0, yPos)
        btn.BackgroundColor3 = color
        btn.Text = text
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 14
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)
        return btn
    end

    -- Title
    local title = Instance.new("TextLabel", MainFrame)
    title.Size = UDim2.new(1, 0, 0, 40)
    title.Text = "üéØ BRM5 v4 - by Dexter"
    title.TextColor3 = Color3.new(1, 1, 1)
    title.Font = Enum.Font.GothamBold
    title.BackgroundTransparency = 1
    title.TextSize = 18

    -- C√°c n√∫t ch·ª©c nƒÉng
    local wallBtn = createMenuButton("Wall: OFF", 50, Color3.fromRGB(60, 60, 60))
    local aimBtn = createMenuButton("Aim: OFF", 95, Color3.fromRGB(60, 60, 60))
    local fovBtn = createMenuButton("FOV: OFF", 140, Color3.fromRGB(60, 60, 60))
    local recoilBtn = createMenuButton("No Recoil: OFF", 185, Color3.fromRGB(60, 60, 60))
    local unloadBtn = createMenuButton("Unload Script", 370, Color3.fromRGB(150, 0, 0))

    -- Logic Wall/Aim c∆° b·∫£n (R√∫t g·ªçn ƒë·ªÉ tr√°nh l·ªói hi·ªÉn th·ªã nh∆∞ng v·∫´n gi·ªØ ch·ª©c nƒÉng)
    wallBtn.MouseButton1Click:Connect(function()
        wallEnabled = not wallEnabled
        wallBtn.Text = "Wall: " .. (wallEnabled and "ON" or "OFF")
        wallBtn.BackgroundColor3 = wallEnabled and Color3.fromRGB(0, 170, 0) or Color3.fromRGB(60, 60, 60)
    end)

    aimBtn.MouseButton1Click:Connect(function()
        aimEnabled = not aimEnabled
        aimBtn.Text = "Aim: " .. (aimEnabled and "ON" or "OFF")
        aimBtn.BackgroundColor3 = aimEnabled and Color3.fromRGB(0, 170, 0) or Color3.fromRGB(60, 60, 60)
    end)

    unloadBtn.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
    end)

    -- Ph√≠m Insert d·ª± ph√≤ng
    UserInputService.InputBegan:Connect(function(input, proc)
        if not proc and input.KeyCode == Enum.KeyCode.Insert then
            MainFrame.Visible = not MainFrame.Visible
        end
    end)

    print("Dexter Fix Loaded! Use the 'D' button to toggle menu.")
end)

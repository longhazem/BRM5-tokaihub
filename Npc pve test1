-- /// ZOM-HUB V10 (SUPER SMOOTH & ANTI-CHEAT BYPASS) ///
local Settings = {
    HitboxSize = 12, -- Kích thước ảo (Cực kỳ an toàn)
    Enabled = true,
    NoRecoil = true
}

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local Camera = workspace.CurrentCamera

-- Tối ưu hóa: Chỉ quét NPC 1 lần mỗi giây thay vì mỗi khung hình
local ValidNPCs = {}
task.spawn(function()
    while task.wait(1) do
        local temp = {}
        -- Chỉ quét các Model trong workspace để tránh lag
        for _, v in ipairs(workspace:GetChildren()) do
            if v:IsA("Model") and (v.Name == "Male" or v.Name == "Zombie" or v.Name == "Zombies") then
                local head = v:FindFirstChild("Head")
                local hum = v:FindFirstChildOfClass("Humanoid")
                if head and hum and hum.Health > 0 then
                    table.insert(temp, head)
                end
            end
        end
        ValidNPCs = temp
    end
end)

-- /// SILENT AIM BẰNG CÁCH THAY THẾ MOUSE.HIT (KHÔNG LAG) ///
local mt = getrawmetatable(game)
local oldIndex = mt.__index
setreadonly(mt, false)

mt.__index = newcclosure(function(self, idx)
    -- Kiểm tra nếu game đang hỏi vị trí chuột (để bắn)
    if self == Mouse and (idx == "Hit" or idx == "Target") and Settings.Enabled then
        local nearestNPC = nil
        local minDistance = Settings.HitboxSize * 8 -- Tầm hút đạn (pixel)

        for _, head in ipairs(ValidNPCs) do
            if head and head.Parent then
                local pos, onScreen = Camera:WorldToViewportPoint(head.Position)
                if onScreen then
                    local mousePos = Vector2.new(Mouse.X, Mouse.Y)
                    local dist = (Vector2.new(pos.X, pos.Y) - mousePos).Magnitude
                    
                    if dist < minDistance then
                        nearestNPC = head
                        minDistance = dist
                    end
                end
            end
        end

        if nearestNPC then
            -- Trả về vị trí của NPC thay vì vị trí chuột thật
            return (idx == "Hit" and nearestNPC.CFrame or nearestNPC)
        end
    end
    return oldIndex(self, idx)
end)

setreadonly(mt, true)

-- /// NO RECOIL AN TOÀN ///
game:GetService("RunService").RenderStepped:Connect(function()
    if Settings.NoRecoil and Camera:FindFirstChild("Spring") then
        Camera.Spring.Value = Vector3.new(0, 0, 0)
    end
end)

print("ZOM-HUB V10: Smooth & Safe Loaded")

-- Script tạo nền tảng tự động có giao diện Bật/Tắt (Đã sửa lỗi vị trí UI)
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- --- CẤU HÌNH ---
local PLATFORM_SIZE = Vector3.new(6, 0.5, 6)
local PLATFORM_COLOR = Color3.fromRGB(0, 255, 255)
local isEnabled = false 

-- --- TẠO GIAO DIỆN (UI) ---
-- Xóa UI cũ nếu tồn tại để tránh trùng lặp
if playerGui:FindFirstChild("PlatformControlGui") then
	playerGui.PlatformControlGui:Destroy()
end

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "PlatformControlGui"
screenGui.ResetOnSpawn = false
screenGui.DisplayOrder = 10 -- Đảm bảo hiện lên trên cùng
screenGui.Parent = playerGui

local mainButton = Instance.new("TextButton")
mainButton.Name = "ToggleButton"
-- Đặt vị trí ở giữa bên trái màn hình để chắc chắn nhìn thấy
mainButton.Size = UDim2.new(0, 150, 0, 50)
mainButton.Position = UDim2.new(0, 20, 0.5, 0) 
mainButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
mainButton.BackgroundTransparency = 0.3
mainButton.Text = "PLATFORM: OFF"
mainButton.TextColor3 = Color3.fromRGB(255, 0, 0)
mainButton.Font = Enum.Font.GothamBlack
mainButton.TextSize = 16
mainButton.Parent = screenGui

local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 10)
uiCorner.Parent = mainButton

local uiStroke = Instance.new("UIStroke") -- Thêm viền cho nút
uiStroke.Thickness = 2
uiStroke.Color = Color3.fromRGB(255, 255, 255)
uiStroke.Parent = mainButton

-- Hiệu ứng UI
local function updateUI()
	if isEnabled then
		mainButton.Text = "PLATFORM: ON"
		mainButton.TextColor3 = Color3.fromRGB(0, 255, 255)
		uiStroke.Color = Color3.fromRGB(0, 255, 255)
	else
		mainButton.Text = "PLATFORM: OFF"
		mainButton.TextColor3 = Color3.fromRGB(255, 0, 0)
		uiStroke.Color = Color3.fromRGB(255, 255, 255)
	end
end

mainButton.MouseButton1Click:Connect(function()
	isEnabled = not isEnabled
	updateUI()
end)

-- --- LOGIC TẠO NỀN TẢNG ---
local function getRoot()
	local char = player.Character
	return char and char:FindFirstChild("HumanoidRootPart")
end

local lastPos = Vector3.new()

RunService.Heartbeat:Connect(function()
	if not isEnabled then return end
	
	local root = getRoot()
	if root then
		if (root.Position - lastPos).Magnitude > 3 then
			local p = Instance.new("Part")
			p.Size = PLATFORM_SIZE
			p.Color = PLATFORM_COLOR
			p.Material = Enum.Material.Neon
			p.Transparency = 0.5
			p.Anchored = true
			p.CanCollide = true
			p.Position = root.Position - Vector3.new(0, 3.5, 0)
			p.Parent = workspace
			
			lastPos = root.Position
			
			task.delay(0.5, function()
				local t = TweenService:Create(p, TweenInfo.new(0.3), {Transparency = 1})
				t:Play()
				t.Completed:Wait()
				p:Destroy()
			end)
		end
	end
end)

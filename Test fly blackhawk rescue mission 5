--[[ 
    --uhsh--
    SỐ THỨ TỰ: 01
    CHỨC NĂNG: TẠO NỀN TẢNG DƯỚI CHÂN CÓ NÚT BẬT TẮT
    --uhsh--
]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local pGui = player:WaitForChild("PlayerGui")

-- --- CÀI ĐẶT ---
local isEnabled = false
local lastPos = Vector3.new(0, 0, 0)

-- --- TẠO GIAO DIỆN (ÉP BUỘC HIỂN THỊ) ---
local sg = Instance.new("ScreenGui")
sg.Name = "MagicPlatformUI"
sg.IgnoreGuiInset = true -- Bỏ qua các khoảng cách an toàn của hệ thống
sg.DisplayOrder = 999999 -- Luôn nằm trên cùng các UI khác
sg.Parent = pGui

local btn = Instance.new("TextButton")
btn.Name = "MainToggle"
btn.Size = UDim2.new(0, 160, 0, 55)
btn.Position = UDim2.new(0.5, -80, 0.1, 0) -- Đặt ở chính giữa phía trên màn hình để dễ tìm
btn.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
btn.BorderSizePixel = 3
btn.BorderColor3 = Color3.fromRGB(255, 255, 255)
btn.Text = "PLATFORM: OFF"
btn.Font = Enum.Font.SourceSansBold
btn.TextSize = 20
btn.TextColor3 = Color3.fromRGB(255, 50, 50)
btn.ZIndex = 10
btn.Parent = sg

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = btn

-- --- LOGIC BẬT TẮT ---
btn.MouseButton1Click:Connect(function()
	isEnabled = not isEnabled
	
	if isEnabled then
		btn.Text = "PLATFORM: ON"
		btn.TextColor3 = Color3.fromRGB(0, 255, 255)
		btn.BorderColor3 = Color3.fromRGB(0, 255, 255)
	else
		btn.Text = "PLATFORM: OFF"
		btn.TextColor3 = Color3.fromRGB(255, 50, 50)
		btn.BorderColor3 = Color3.fromRGB(255, 255, 255)
	end
    
    -- Hiệu ứng nhấn nút
    btn:TweenSize(UDim2.new(0, 150, 0, 50), "Out", "Quad", 0.1, true)
    task.wait(0.1)
    btn:TweenSize(UDim2.new(0, 160, 0, 55), "Out", "Quad", 0.1, true)
end)

-- --- LOGIC TẠO NỀN TẢNG ---
RunService.Heartbeat:Connect(function()
	if not isEnabled then return end
	
	local char = player.Character
	local hrp = char and char:FindFirstChild("HumanoidRootPart")
	
	if hrp then
		-- Chỉ tạo khi di chuyển hoặc nhảy
		if (hrp.Position - lastPos).Magnitude > 2.5 then
			local part = Instance.new("Part")
			part.Size = Vector3.new(6, 0.6, 6)
			part.Color = Color3.fromRGB(0, 255, 255)
			part.Material = Enum.Material.Neon
			part.Transparency = 0.4
			part.Anchored = true
			part.CanCollide = true
			part.CastShadow = false
			
			-- Vị trí dưới chân (3.2 là khoảng cách tiêu chuẩn)
			part.Position = hrp.Position - Vector3.new(0, 3.2, 0)
			part.Parent = workspace
			
			lastPos = hrp.Position
			
			-- Hiệu ứng biến mất
			task.delay(0.4, function()
				local tw = TweenService:Create(part, TweenInfo.new(0.3), {Transparency = 1, Size = Vector3.new(0,0,0)})
				tw:Play()
				tw.Completed:Wait()
				part:Destroy()
			end)
		end
	end
end)

-- --uhsh-- KẾT THÚC --uhsh--

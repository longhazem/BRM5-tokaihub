--[[ 
    --uhsh--
    SỐ THỨ TỰ: 08 (Bản mô phỏng theo cấu trúc Path trong Dex)
    CHỨC NĂNG: TẠO CHUỖI "PATH" DƯỚI CHÂN NGƯỜI CHƠI
    --uhsh--
]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local pGui = player:WaitForChild("PlayerGui")

-- --- CẤU HÌNH THEO ẢNH DEX ---
local isEnabled = false
local lastPos = Vector3.new(0, 0, 0)

-- Thông số Part giống trong ảnh Properties bạn gửi
local PART_NAME = "Path"
local PART_COLOR = Color3.fromRGB(85, 255, 255) -- Màu Cyan giống ảnh
local PART_SIZE = Vector3.new(8, 0.5, 8) -- Kích thước miếng nền
local PART_TRANSPARENCY = 0.5
local PART_MATERIAL = Enum.Material.Neon

-- --- TẠO GIAO DIỆN (UI) ---
local sg = Instance.new("ScreenGui")
sg.Name = "PathSystemGui"
sg.ResetOnSpawn = false
sg.DisplayOrder = 1000
sg.Parent = pGui

local btn = Instance.new("TextButton")
btn.Name = "TogglePath"
btn.Size = UDim2.new(0, 150, 0, 45)
btn.Position = UDim2.new(0.5, -75, 0.02, 0)
btn.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
btn.BorderSizePixel = 2
btn.BorderColor3 = Color3.fromRGB(0, 255, 255)
btn.Text = "PLATFORM: ON" -- Đặt mặc định hoặc đổi sau
btn.TextColor3 = Color3.fromRGB(0, 255, 255)
btn.Font = Enum.Font.GothamBlack
btn.TextSize = 16
btn.Parent = sg

Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)

-- --- LOGIC TẠO PATH ---
local function createPath(pos)
    local pathPart = Instance.new("Part")
    pathPart.Name = PART_NAME
    pathPart.Size = PART_SIZE
    pathPart.Color = PART_COLOR
    pathPart.Material = PART_MATERIAL
    pathPart.Transparency = PART_TRANSPARENCY
    pathPart.Anchored = true
    pathPart.CanCollide = true -- Quan trọng để đứng được
    pathPart.CastShadow = false
    
    -- Đặt vị trí (trừ đi khoảng cách dưới chân)
    pathPart.CFrame = CFrame.new(pos.X, pos.Y - 3.3, pos.Z)
    
    pathPart.Parent = game.Workspace
    
    -- Xóa sau một lúc giống như vòng lặp bạn mô tả
    task.delay(0.5, function()
        if pathPart then
            pathPart:Destroy()
        end
    end)
end

-- --- BẬT TẮT ---
btn.MouseButton1Click:Connect(function()
    isEnabled = not isEnabled
    if isEnabled then
        btn.Text = "PLATFORM: ON"
        btn.TextColor3 = Color3.fromRGB(0, 255, 255)
        btn.BorderColor3 = Color3.fromRGB(0, 255, 255)
    else
        btn.Text = "PLATFORM: OFF"
        btn.TextColor3 = Color3.fromRGB(255, 50, 50)
        btn.BorderColor3 = Color3.fromRGB(255, 255, 255)
    end
end)

-- --- VÒNG LẶP KIỂM TRA ---
RunService.Heartbeat:Connect(function()
    if not isEnabled then return end
    
    local char = player.Character
    local hrp = char and char:FindFirstChild("HumanoidRootPart")
    
    if hrp then
        -- Tạo khi di chuyển hoặc nhảy (Khoảng cách giữa các miếng là 2 đơn vị)
        if (hrp.Position - lastPos).Magnitude > 2 then
            createPath(hrp.Position)
            lastPos = hrp.Position
        end
    end
end)

-- Cập nhật lại khi nhân vật hồi sinh
player.CharacterAdded:Connect(function()
    lastPos = Vector3.new(0,0,0)
end)

-- --uhsh-- KẾT THÚC --uhsh--

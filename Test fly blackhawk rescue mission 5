--[[ 
    --uhsh--
    SỐ THỨ TỰ: 02 (Bản sửa lỗi tạo Part)
    CHỨC NĂNG: TẠO NỀN TẢNG LIÊN TỤC KHI BẬT
    --uhsh--
]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local pGui = player:WaitForChild("PlayerGui")

-- --- CÀI ĐẶT ---
local isEnabled = false

-- --- TẠO GIAO DIỆN ---
local sg = Instance.new("ScreenGui")
sg.Name = "MagicPlatformUI"
sg.IgnoreGuiInset = true
sg.DisplayOrder = 999999
sg.Parent = pGui

local btn = Instance.new("TextButton")
btn.Name = "MainToggle"
btn.Size = UDim2.new(0, 160, 0, 50)
btn.Position = UDim2.new(0.5, -80, 0.05, 0) -- Ở giữa phía trên
btn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
btn.Text = "PLATFORM: OFF"
btn.Font = Enum.Font.GothamBold
btn.TextSize = 18
btn.TextColor3 = Color3.fromRGB(255, 50, 50)
btn.Parent = sg

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 10)
corner.Parent = btn

btn.MouseButton1Click:Connect(function()
	isEnabled = not isEnabled
	if isEnabled then
		btn.Text = "PLATFORM: ON"
		btn.TextColor3 = Color3.fromRGB(0, 255, 255)
	else
		btn.Text = "PLATFORM: OFF"
		btn.TextColor3 = Color3.fromRGB(255, 50, 50)
	end
end)

-- --- LOGIC TẠO NỀN TẢNG (CHẠY THEO VÒNG LẶP THỜI GIAN) ---
-- Sử dụng task.spawn để chạy vòng lặp riêng biệt, không bị ảnh hưởng bởi lag
task.spawn(function()
	while true do
		task.wait(0.05) -- Tạo tấm đế mới mỗi 0.05 giây nếu đang bật
		
		if isEnabled then
			local char = player.Character
			local hrp = char and char:FindFirstChild("HumanoidRootPart")
			
			if hrp then
				local part = Instance.new("Part")
				part.Name = "FootPlatform"
				part.Size = Vector3.new(6, 0.8, 6)
				part.Color = Color3.fromRGB(0, 255, 255)
				part.Material = Enum.Material.Neon
				part.Transparency = 0.5
				part.Anchored = true
				part.CanCollide = true
				part.CastShadow = false
				
				-- Đặt vị trí chính xác dưới chân (khoảng 3.6 đơn vị)
				-- Nếu bạn thấy nó quá cao, hãy tăng số 3.6 lên thành 3.8 hoặc 4.0
				part.Position = hrp.Position - Vector3.new(0, 3.6, 0)
				
				-- Cho vào Folder trong Workspace để gọn gàng
				local folder = workspace:FindFirstChild("MagicSteps") or Instance.new("Folder", workspace)
				folder.Name = "MagicSteps"
				part.Parent = folder
				
				-- Hiệu ứng xóa bỏ
				task.delay(0.3, function()
					local tween = TweenService:Create(part, TweenInfo.new(0.2), {Transparency = 1, Size = Vector3.new(0, 0.8, 0)})
					tween:Play()
					tween.Completed:Wait()
					part:Destroy()
				end)
			end
		end
	end
end)

-- --uhsh-- KẾT THÚC --uhsh--

local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local SoundService = game:GetService("SoundService")
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RS = game:GetService("ReplicatedStorage")
local lighting = game:GetService("Lighting")

-- [ORIGINAL LOGIC - DO NOT TOUCH]
local localPlayer = Players.LocalPlayer
local camera = Workspace.CurrentCamera
local TARGET_HITBOX_SIZE = Vector3.new(15, 15, 15)
local activeNPCs = {}      
local trackedParts = {}    
local originalSizes = {}   
local wallConnections = {} 

local wallEnabled = false       
local silentEnabled = false     
local showHitbox = false        
local fullBrightEnabled = false 


local isUnloaded = false        
local fastScanEnabled = false   
local patchOptions = { recoil = false, firemodes = false }

local maleColor = Color3.fromRGB(0, 255, 0)
local zombieColor = Color3.fromRGB(255, 0, 0)

local originalLighting = {
    Brightness = lighting.Brightness,
    ClockTime = lighting.ClockTime,
    FogEnd = lighting.FogEnd,
    GlobalShadows = lighting.GlobalShadows,
    Ambient = lighting.Ambient
}

local function getRootPart(model)
    return model:FindFirstChild("Root") or model:FindFirstChild("HumanoidRootPart") or model:FindFirstChild("UpperTorso")
end

local function isValidNPC(model)
    local name = model.Name:lower()
    local isTargetName = (name == "male" 
or name == "zombie" or name == "zombies")
    if name == "male" then
        local hasAI = false
        for _, c in ipairs(model:GetChildren()) do
            if type(c.Name) == "string" and c.Name:sub(1, 3) == "AI_" then hasAI = true break end
        end
        return hasAI
    end
    return isTargetName
end

local function createBoxForPart(part)
    if not part 
or part:FindFirstChild("Wall_Box") then return end
    local sphere = Instance.new("SphereHandleAdornment")
    sphere.Name = "Wall_Box"
    sphere.Radius = 1.2
    sphere.Adornee = part
    sphere.AlwaysOnTop = true 
    sphere.ZIndex = 10
    sphere.Transparency = 0.1
    
    -- Tối ưu: Gán màu ngay khi tạo thay vì cập nhật liên tục trong loop
    local model = part.Parent
    if model then
        local name = model.Name:lower()
     
   sphere.Color3 = (name == "zombie" or name == "zombies") and zombieColor or maleColor
    end
    
    sphere.Parent = part
    trackedParts[part] = true
end

local function destroyAllBoxes()
    for part, _ in pairs(trackedParts) do
        if part and part:FindFirstChild("Wall_Box") then pcall(function() part.Wall_Box:Destroy() end) end
    end
    trackedParts = {}
end

local function applySilentHitbox(model, head)
    if not originalSizes[model] then originalSizes[model] = head.Size end
    head.Size = TARGET_HITBOX_SIZE
    head.Transparency = showHitbox and 
0.85 or 1 
    head.Color = Color3.fromRGB(255, 0, 0)
    head.CanCollide = true
end

local function restoreOriginalSize(model)
    local head = model:FindFirstChild("Head")
    if head and originalSizes[model] then
        head.Size = originalSizes[model]
        head.Transparency = 1
        head.CanCollide = false
    end
    originalSizes[model] = nil
end

local function addNPC(model)
    if activeNPCs[model] or not isValidNPC(model) then return end
    local head = model:FindFirstChild("Head")
    local root 
= getRootPart(model)
    if not (head or root) then return end
    activeNPCs[model] = { head = head or root, root = root }
    if wallEnabled then createBoxForPart(head or root) end
end

local function patchWeapons(options)
    local weaponsFolder = RS:FindFirstChild("Shared")
        and RS.Shared:FindFirstChild("Configs")
        and RS.Shared.Configs:FindFirstChild("Weapon")
        and RS.Shared.Configs.Weapon:FindFirstChild("Weapons_Player")
  
    if not weaponsFolder then return end
    for _, platform in pairs(weaponsFolder:GetChildren()) do
       
 if platform.Name:match("^Platform_") then
            for _, weapon in pairs(platform:GetChildren()) do
                for _, child in pairs(weapon:GetChildren()) do
                    if child:IsA("ModuleScript") and child.Name:match("^Receiver%.") then
                        local success, receiver = pcall(require, child)
      
                  if success and receiver and receiver.Config and receiver.Config.Tune then
                            local tune = receiver.Config.Tune
                            if options.recoil then
             
                   tune.Recoil_X = 0 tune.Recoil_Z = 0 tune.RecoilForce_Tap = 0
                                tune.RecoilForce_Impulse = 0 tune.Recoil_Range = Vector2.zero
                                tune.Recoil_Camera = 0 tune.RecoilAccelDamp_Crouch 
= Vector3.new(1, 1, 1)
                                tune.RecoilAccelDamp_Prone = Vector3.new(1, 1, 1)
                            end
                            if options.firemodes then tune.Firemodes = 
{3, 2, 1, 0} end
                        end
                    end
                end
            end
        end
    end
end

-- [LIBRARY CONFIG]
local function CleanupOldUI()
    local oldUI = (gethui 
and gethui():FindFirstChild("TOKAIHUB")) or game.CoreGui:FindFirstChild("TOKAIHUB")
    if oldUI then oldUI:Destroy() end
end
CleanupOldUI()

local BackgroundList = {
    "rbxthumb://type=Asset&id=13605715274&w=420&h=420",
    "rbxthumb://type=Asset&id=10935179737&w=420&h=420",
    "rbxthumb://type=Asset&id=97182163526089&w=420&h=420",
    "rbxthumb://type=Asset&id=114016973837508&w=420&h=420",
    "rbxthumb://type=Asset&id=101612750444882&w=420&h=420",
    "rbxthumb://type=Asset&id=2014971747&w=420&h=420",
    "rbxthumb://type=Asset&id=101959737652480&w=420&h=420",
    "rbxthumb://type=Asset&id=110802555840064&w=420&h=420",
    "rbxthumb://type=Asset&id=598493435&w=420&h=420",
    "rbxthumb://type=Asset&id=10007194277&w=420&h=420"
}
if not _G.BackgroundState then _G.BackgroundState = { CurrentIndex = 1, LastUpdate = tick() } end

local function PlayCustomClick()
    local sound = Instance.new("Sound")
    sound.SoundId = "rbxassetid://126347354635406"
    sound.Volume = 0.8
    sound.Parent = SoundService
    sound:Play()
 
   sound.Ended:Connect(function() sound:Destroy() end)
end

local Library = {}
function Library:CreateWindow()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "TOKAIHUB"
    screenGui.Parent = (gethui and gethui()) or game.CoreGui
    screenGui.ResetOnSpawn = false
    local mainSize = UDim2.new(0, 520, 0, 320)
    local logoID = "rbxthumb://type=Asset&id=99217897221957&w=420&h=420"

    local openBtn = Instance.new("ImageButton", screenGui)
    openBtn.Name = "OpenButton"
    openBtn.Size = UDim2.new(0, 55, 0, 55)
    openBtn.Position = UDim2.new(0, 20, 0.5, -27)
    openBtn.Visible = false
    openBtn.BackgroundColor3 = Color3.fromRGB(20, 
20, 20)
    openBtn.Image = logoID
    openBtn.ZIndex = 100
    Instance.new("UICorner", openBtn).CornerRadius = UDim.new(1, 0)
    local openStroke = Instance.new("UIStroke", openBtn)
    openStroke.Thickness = 2

    local main = Instance.new("Frame", screenGui)
    main.Name = "MainFrame"
    main.Size = UDim2.new(0, 0, 0, 0)
    main.Position = UDim2.new(0.5, 0, 0.5, 0)
    main.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    main.BackgroundTransparency = 0.2
    main.AnchorPoint = Vector2.new(0.5, 0.5)
    main.ClipsDescendants = true
    main.Active = 
true
    Instance.new("UICorner", main).CornerRadius = UDim.new(0, 10)
    local mainStroke = Instance.new("UIStroke", main)
    mainStroke.Thickness = 2

    local mainBg = Instance.new("ImageLabel", main)
    mainBg.Name = "Background"
    mainBg.Size = UDim2.new(1, 0, 1, 0)
    mainBg.BackgroundTransparency = 1
    mainBg.Image = BackgroundList[_G.BackgroundState.CurrentIndex]
    mainBg.ImageTransparency = 0.4
    mainBg.ScaleType = Enum.ScaleType.Crop
    mainBg.ZIndex = 1

    TweenService:Create(main, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Size = mainSize}):Play()

    task.spawn(function()
        while task.wait(1) do
 
           if not screenGui.Parent then break end
            if tick() - _G.BackgroundState.LastUpdate >= 300 then
                _G.BackgroundState.LastUpdate = tick()
                _G.BackgroundState.CurrentIndex = (_G.BackgroundState.CurrentIndex % #BackgroundList) + 1
                local tw = TweenService:Create(mainBg, TweenInfo.new(1.5), {ImageTransparency = 1})
   
             tw:Play()
                tw.Completed:Wait()
                mainBg.Image = BackgroundList[_G.BackgroundState.CurrentIndex]
                TweenService:Create(mainBg, TweenInfo.new(1.5), {ImageTransparency = 0.4}):Play()
            end
        end
    end)

    local sidebar = Instance.new("Frame", main)
 
   sidebar.Name = "Sidebar"
    sidebar.Size = UDim2.new(0, 150, 1, 0)
    sidebar.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    sidebar.BackgroundTransparency = 0.4
    sidebar.ZIndex = 10
    Instance.new("UICorner", sidebar).CornerRadius = UDim.new(0, 10)

    local header = Instance.new("Frame", sidebar)
    header.Name = "Header"
    header.Size = UDim2.new(1, 0, 0, 60)
    header.BackgroundTransparency = 1
    header.ZIndex = 11

    local logoImg = Instance.new("ImageLabel", header)
    logoImg.Size = UDim2.new(0, 35, 0, 35)
    logoImg.Position = 
UDim2.new(0, 12, 0.5, -17)
    logoImg.BackgroundTransparency = 1
    logoImg.Image = logoID
    logoImg.ZIndex = 12
    Instance.new("UICorner", logoImg).CornerRadius = UDim.new(1, 0)
    local logoStroke = Instance.new("UIStroke", logoImg)
    logoStroke.Color = Color3.fromRGB(255, 255, 255)
    logoStroke.Thickness = 1.5

    local titleText = Instance.new("TextLabel", header)
    titleText.Size = UDim2.new(1, -55, 1, 0)
    titleText.Position = UDim2.new(0, 52, 0, 0)
    titleText.BackgroundTransparency = 1
    titleText.Text = "TOKAI HUB"
    titleText.TextColor3 = Color3.fromRGB(255, 255, 255)
  
  titleText.Font = Enum.Font.GothamBold
    titleText.TextSize = 13
    titleText.TextXAlignment = Enum.TextXAlignment.Left
    titleText.ZIndex = 12

    local pages = Instance.new("Frame", main)
    pages.Name = "Pages"
    pages.Size = UDim2.new(1, -170, 1, -20)
    pages.Position = UDim2.new(0, 160, 0, 10)
    pages.BackgroundTransparency = 1
    pages.ZIndex = 20

    local tabList = Instance.new("ScrollingFrame", sidebar)
    tabList.Name = "TabList"
    tabList.Size = UDim2.new(1, 0, 1, -70)
    tabList.Position = UDim2.new(0, 0, 0, 65)
  
  tabList.BackgroundTransparency = 1
    tabList.ScrollBarThickness = 0
    tabList.ZIndex = 11
    local listLayout = Instance.new("UIListLayout", tabList)
    listLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    listLayout.Padding = UDim.new(0, 6)

    local currentOrbit = nil
    local function CreateOrbitEffect(targetBtn)
        if currentOrbit then currentOrbit:Destroy() end
        local orbit = Instance.new("Frame")
        orbit.Size = UDim2.new(0, 5, 0, 5)
        orbit.BackgroundColor3 = Color3.fromRGB(255, 245, 150)
  
      orbit.BorderSizePixel = 0
        orbit.ZIndex = 50
        orbit.Parent = targetBtn
        Instance.new("UICorner", orbit).CornerRadius = UDim.new(1, 0)
        local glow = Instance.new("ImageLabel", orbit)
        glow.Size = UDim2.new(4, 0, 4, 0);
glow.Position = UDim2.new(-1.5, 0, -1.5, 0)
        glow.BackgroundTransparency = 1; glow.Image = "rbxassetid://6015667101";
glow.ImageColor3 = Color3.fromRGB(255, 240, 100); glow.ZIndex = 49
        currentOrbit = orbit
        task.spawn(function()
            local a = 0
            while orbit and orbit.Parent == targetBtn do
                a = a + 5
                local r = math.rad(a)
   
             orbit.Position = UDim2.new(0.5, math.cos(r)*(targetBtn.AbsoluteSize.X/2+3), 0.5, math.sin(r)*(targetBtn.AbsoluteSize.Y/2+3))
                RunService.RenderStepped:Wait()
            end
        end)
    end

    local firstTab = true
    function Library:CreateTab(name)
        local page = Instance.new("ScrollingFrame", pages)
        page.Name = name .. "Page"
      
  page.Size = UDim2.new(1, 0, 1, 0)
        page.BackgroundTransparency = 1
        page.Visible = false
        page.ScrollBarThickness = 2
        page.ZIndex = 21
        local pageLayout = Instance.new("UIListLayout", page)
        pageLayout.Padding = UDim.new(0, 10)
        pageLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

        local tabBtn = Instance.new("TextButton", tabList)
        
tabBtn.Size = UDim2.new(0, 130, 0, 36)
        tabBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
        tabBtn.BackgroundTransparency = 0.5
        tabBtn.Text = name
        tabBtn.TextColor3 = Color3.fromRGB(180, 180, 180)
        tabBtn.Font = Enum.Font.GothamSemibold
        tabBtn.TextSize = 13
        tabBtn.ZIndex = 15
        Instance.new("UICorner", tabBtn)
        local tabStroke = Instance.new("UIStroke", 
tabBtn)
        tabStroke.Thickness = 0;
tabStroke.Color = Color3.fromRGB(255, 245, 150)

        tabBtn.MouseButton1Click:Connect(function()
            PlayCustomClick()
            for _, v in pairs(pages:GetChildren()) do if v:IsA("ScrollingFrame") then v.Visible = false end end
            for _, v in pairs(tabList:GetChildren()) do 
                if v:IsA("TextButton") then 
              
      v.TextColor3 = Color3.fromRGB(180, 180, 180)
                    v.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
                    v:FindFirstChildOfClass("UIStroke").Thickness = 0
                end 
            end
            page.Visible = true
 
           tabBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
            tabBtn.BackgroundColor3 = Color3.fromRGB(70, 65, 35)
            tabStroke.Thickness = 1.5
            CreateOrbitEffect(tabBtn)
        end)

        if firstTab then
            task.delay(0.1, function()
            
    page.Visible = true; tabBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
                tabBtn.BackgroundColor3 = Color3.fromRGB(70, 65, 35);
tabStroke.Thickness = 1.5
                CreateOrbitEffect(tabBtn)
            end)
            firstTab = false
        end

        local elements = {}
        function elements:AddToggle(text, callback)
            local toggleFrame = Instance.new("TextButton", page)
           
 toggleFrame.Size = UDim2.new(1, -10, 0, 40)
            toggleFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
            toggleFrame.Text = ""
            toggleFrame.AutoButtonColor = false
            toggleFrame.ZIndex = 25
            Instance.new("UICorner", toggleFrame)
            
           
 local label = Instance.new("TextLabel", toggleFrame)
            label.Size = UDim2.new(1, -60, 1, 0);
label.Position = UDim2.new(0, 15, 0, 0)
            label.BackgroundTransparency = 1;
label.Text = text; label.TextColor3 = Color3.fromRGB(255, 255, 255)
            label.Font = Enum.Font.Gotham;
label.TextSize = 13; label.TextXAlignment = Enum.TextXAlignment.Left; label.ZIndex = 26

            local tglBg = Instance.new("Frame", toggleFrame)
            tglBg.Size = UDim2.new(0, 42, 0, 22);
tglBg.Position = UDim2.new(1, -52, 0.5, -11)
            tglBg.BackgroundColor3 = Color3.fromRGB(60, 60, 60);
tglBg.ZIndex = 26
            Instance.new("UICorner", tglBg).CornerRadius = UDim.new(1, 0)

            local tglDot = Instance.new("Frame", tglBg)
            tglDot.Size = UDim2.new(0, 18, 0, 18);
tglDot.Position = UDim2.new(0, 2, 0.5, -9)
            tglDot.BackgroundColor3 = Color3.fromRGB(255, 255, 255);
tglDot.ZIndex = 27
            Instance.new("UICorner", tglDot).CornerRadius = UDim.new(1, 0)

            local enabled = false
            local function update()
                TweenService:Create(tglDot, TweenInfo.new(0.2), {Position = enabled and UDim2.new(0, 22, 0.5, -9) or UDim2.new(0, 2, 0.5, -9)}):Play()
                TweenService:Create(tglBg, TweenInfo.new(0.2), {BackgroundColor3 = enabled and Color3.fromRGB(255, 
245, 100) or Color3.fromRGB(60, 60, 60)}):Play()
            end

            toggleFrame.MouseButton1Click:Connect(function()
                PlayCustomClick()
                enabled = not enabled
                update()
                callback(enabled)
    
        end)
        end

        function elements:AddButton(text, callback)
            local btn = Instance.new("TextButton", page)
            btn.Size = UDim2.new(1, -10, 0, 40)
            btn.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
            btn.Text = "  " .. text
       
     btn.TextColor3 = Color3.fromRGB(255, 255, 255)
            btn.Font = Enum.Font.Gotham;
btn.TextSize = 13; btn.TextXAlignment = Enum.TextXAlignment.Left
            btn.ZIndex = 25
            Instance.new("UICorner", btn)
            btn.MouseButton1Click:Connect(function()
                PlayCustomClick()
                callback()
            end)
        end
    
    return elements
    end

    local closeBtn = Instance.new("TextButton", main)
    closeBtn.Size = UDim2.new(0, 30, 0, 30);
closeBtn.Position = UDim2.new(1, -35, 0, 5)
    closeBtn.BackgroundTransparency = 1; closeBtn.Text = "×";
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeBtn.TextSize = 25;
closeBtn.ZIndex = 50
    closeBtn.MouseButton1Click:Connect(function()
        PlayCustomClick()
        TweenService:Create(main, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.In), {Size = UDim2.new(0, 0, 0, 0)}):Play()
        task.delay(0.4, function() main.Visible = false; openBtn.Visible = true end)
    end)

    local function Drag(obj)
        local dragging, dragInput, dragStart, startPos
        obj.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
   
             dragging = true; dragStart = input.Position; startPos = obj.Position
            end
        end)
        UserInputService.InputChanged:Connect(function(input)
            if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                local delta = input.Position - dragStart
        
        obj.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            end
        end)
        UserInputService.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then dragging = false end
        end)
    end
    Drag(main);
Drag(openBtn)

    openBtn.MouseButton1Click:Connect(function()
        PlayCustomClick(); openBtn.Visible = false; main.Visible = true
        main.Position = UDim2.new(0.5, 0, 0.5, 0)
        TweenService:Create(main, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Size = mainSize}):Play()
    end)

    coroutine.wrap(function()
        local h = 0
        while screenGui.Parent do
            h = h + 1/400; local c = Color3.fromHSV(h%1, 0.6, 1)
    
        mainStroke.Color = c; openStroke.Color = c; logoStroke.Color = c
            RunService.RenderStepped:Wait()
        end
    end)()
    return Library, screenGui
end

-- [MAIN INITIALIZATION]
local win, rootGui = Library:CreateWindow()

local combatTab = win:CreateTab("Combat")
combatTab:AddToggle("Silent Hitbox (All NPCs)", function(v) silentEnabled = v end)
combatTab:AddToggle("Show Hitbox", function(v) showHitbox = v end)

local visualTab = win:CreateTab("Visuals")
visualTab:AddToggle("ESP Sphere (M:G, Z:R)", function(v)
    wallEnabled = v
    if wallEnabled then for _, d in pairs(activeNPCs) do createBoxForPart(d.head) end else destroyAllBoxes() end
end)
visualTab:AddToggle("Auto 
Fast Scan", function(v)
    fastScanEnabled = v
end)
visualTab:AddToggle("FullBright", function(v)
    fullBrightEnabled = v
    if not v then for p, val in pairs(originalLighting) do lighting[p] = val end end
end)

local weaponTab = win:CreateTab("Weapons")
weaponTab:AddToggle("Anti-Recoil", function(v) patchOptions.recoil = v patchWeapons(patchOptions) end)
weaponTab:AddToggle("Unlock Firemodes", function(v) patchOptions.firemodes = v patchWeapons(patchOptions) end)

local settingsTab = win:CreateTab("Settings")
settingsTab:AddButton("Unload Script", function()
    isUnloaded = true
    destroyAllBoxes()
    for m, _ in pairs(activeNPCs) do restoreOriginalSize(m) end
    for _, c in ipairs(wallConnections) do pcall(function() c:Disconnect() end) end
    rootGui:Destroy()
end)

-- [TỐI ƯU HÓA EXECUTION]
-- 1. Quét NPC 
ban đầu với delay nhỏ để tránh treo khi mới vào game
task.spawn(function()
    local all = Workspace:GetChildren()
    for i, m in ipairs(all) do
        if m:IsA("Model") and isValidNPC(m) then addNPC(m) end
        if i % 10 == 0 then task.wait() end -- Chia nhỏ tiến trình quét
    end
end)

table.insert(wallConnections, Workspace.ChildAdded:Connect(function(m)
    if m:IsA("Model") then 
        task.delay(0.5, function() if isValidNPC(m) then addNPC(m) end end) 
    end
end))

-- 2. Tối ưu vòng 
lặp Fast Scan (Chỉ chạy khi bật và có giới hạn thời gian nghỉ)
task.spawn(function()
    while not isUnloaded do
        if fastScanEnabled then
            local children = Workspace:GetChildren()
            for i, m in ipairs(children) do
                if not isUnloaded and fastScanEnabled then
                 
   if m:IsA("Model") and not activeNPCs[m] then
                        if isValidNPC(m) then addNPC(m) end
                    end
                    if i % 20 == 0 then task.wait() end -- Giảm tải cho CPU
           
     end
            end
        end
        task.wait(1) -- Quét lại mỗi giây thay vì dồn dập
    end
end)

-- 3. Tối ưu RenderStepped (Chỉ xử lý logic thực sự cần thiết mỗi khung hình)
RunService.RenderStepped:Connect(function()
    if isUnloaded then return end
    
    if fullBrightEnabled then
        lighting.Brightness = 2
        lighting.ClockTime = 12
 
       lighting.GlobalShadows = false
        lighting.Ambient = Color3.new(1, 1, 1)
    end
    
    for m, d in pairs(activeNPCs) do
        if not m.Parent then 
            activeNPCs[m] = nil 
            continue 
        end
        
      
  -- Logic Hitbox - Trái tim của script (Giữ nguyên logic gốc)
        if silentEnabled then 
            applySilentHitbox(m, d.head) 
        end
    end
end)

UserInputService.InputBegan:Connect(function(i, gp)
    if not gp and i.KeyCode == Enum.KeyCode.Insert then
        local mainFrame = rootGui:FindFirstChild("MainFrame")
        if mainFrame then
            mainFrame.Visible = not mainFrame.Visible
  
      end
    end
end)

print("Tokai Hub V6 Optimized Successfully.")
